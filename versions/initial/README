This implementation was the first I came up with.
